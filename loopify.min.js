class loopify{constructor(r){this.data=r}_parseVariables(r,e={}){return r.replace(/\{\{([\w.\[\]]+)\}\}/g,((r,t)=>{try{const s=t.replace(/\[/g,".").replace(/\]/g,"").split(".");let n={...e,...this.data};for(const e of s){if(null==n)return r;n=n[e]}return null!=n?String(n):r}catch(e){return r}}))}_processLoops(r){return r.replace(/<!-- LOOP:(\w+)(?:\s+as\s+(\w+))? -->([\s\S]*?)<!-- ENDLOOP -->/g,((r,e,t,s)=>{const n=this.data[e]||[],a=t||"item";return n.map((r=>{const e={[a]:r};return this._parseVariables(s,e)})).join("")}))}mount(r="body"){const e=document.querySelector(r);if(!e)throw new Error(`Элемент "${r}" не найден`);let t=e.innerHTML;t=this._processLoops(t),t=this._parseVariables(t),e.innerHTML=t}}
